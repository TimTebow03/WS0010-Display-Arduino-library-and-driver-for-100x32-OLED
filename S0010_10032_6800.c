//          WINSTAR Display Co.,Ltd 
//    LCM     	 :10032
//    Controller :S0010
//    Interface  :6800
//    Author     :Brian lin 2010/12/13
//    history     :
//==============================================================
#include	<reg51.h>
#include 	<stdio.h>          // define I/O functions
#include 	<INTRINS.H>        // KEIL FUNCTION


#define	one		0x80 // DD RAM Address �Ĥ@�椧�_�l��m0x00
						// �ҥH�]�wDD RAM��}��0x80+0x00=0x80	
#define	two		0xc0 // DD RAM Address �ĤG�椧�_�l��m0x40
						// �ҥH�]�wDD RAM��}��0x80+0x40=0xc0
#define	Data_BUS	P1
#define	CHIP1	0x01
#define	CHIP2	0x02

sbit		busy    =P1^7;
sbit		RS      =P3^0;
sbit	 	RW      =P3^7;
sbit		Enable  =P3^4;
sbit		CS1  =P3^1; 
sbit		CS2  =P3^6;

char bdata  flag;
sbit busy_f  = flag^0;

void CheckBusy(void);
void WriteIns(unsigned char);
void WriteCmd(unsigned char );
void WriteData(unsigned char);
void Show_Pic(unsigned char pic[][100],unsigned char size);
void Initial_OLED();
void delay(unsigned char);



unsigned char code picture[4][100]={ 
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x08,0x08,0x38,0xC8,0x00,0x08,0x08,0x78,
0x88,0x00,0x00,0x88,0x78,0x08,0x08,0x00,
0x88,0x00,0x00,0x80,0x00,0x80,0x80,0x00,
0x00,0x00,0x00,0x80,0x80,0x80,0x00,0x80,
0xE0,0x80,0x80,0x00,0x00,0x80,0x80,0x80,
0x00,0x00,0x00,0x80,0x00,0x80,0x80,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
0x0E,0x30,0x0E,0x01,0x03,0x0C,0x30,0x0F,
0x00,0x00,0x00,0x21,0x3F,0x20,0x21,0x3F,
0x21,0x00,0x20,0x3F,0x20,0x00,0x33,0x24,
0x24,0x19,0x00,0x00,0x3F,0x20,0x10,0x00,
0x39,0x24,0x24,0x12,0x3F,0x20,0x21,0x3F,
0x21,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x08,0x08,0x38,0xC8,0x00,
0x08,0x08,0x78,0x88,0x00,0x00,0x88,0x78,
0x08,0x08,0x08,0x08,0xF8,0x08,0x08,0x08,
0x88,0x18,0x00,0x00,0xC0,0x20,0x10,0x08,
0x08,0x08,0x08,0x10,0x38,0x00,0x00,0x00,
0x10,0x10,0xF8,0x00,0x00,0x00,0x00,0xE0,
0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0xE0,
0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x10,
0x08,0x08,0x88,0x48,0x30,0x00,0x00,0x30,
0x08,0x08,0x08,0x10,0xE0,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x01,0x0E,0x30,0x0E,0x01,0x03,
0x0C,0x30,0x0F,0x00,0x00,0x00,0x20,0x20,
0x3F,0x21,0x21,0x21,0x23,0x30,0x08,0x00,
0x07,0x08,0x10,0x20,0x20,0x20,0x21,0x21,
0x1F,0x01,0x00,0x00,0x00,0x20,0x3F,0x20,
0x00,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,
0x0F,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,
0x0F,0x00,0x00,0x20,0x20,0x21,0x21,0x11,
0x0E,0x00,0x00,0x30,0x28,0x24,0x22,0x21,
0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 
};

unsigned char code picture2[4][100]={ 	//�سW
0x00,0xEE,0xFE,0xFE,0xFC,0xFE,0xBE,0x7E,
0xBE,0x70,0xBE,0x7E,0xBE,0x7E,0xBC,0x7E,
0xBE,0x7E,0xBE,0x70,0xBE,0x7E,0xBE,0x7E,
0xBC,0x7E,0xBE,0x7E,0xBE,0x70,0xBE,0x7E,
0xBE,0x7E,0xBC,0x7E,0xBE,0x7E,0xBE,0x70,
0xBE,0x7E,0xBE,0xFE,0xFC,0xFE,0x7E,0x7E,
0x7E,0xF0,0x7E,0x7E,0x7E,0xFE,0xFC,0xFE,
0xBE,0x7E,0xBE,0x70,0xBE,0x7E,0xBE,0x7E,
0xBC,0x7E,0xBE,0x7E,0xBE,0x70,0xBE,0x7E,
0xBE,0x7E,0xBC,0x7E,0xBE,0x7E,0xBE,0x70,
0xBE,0x7E,0xBE,0x7E,0xBC,0x7E,0xBE,0x7E,
0xBE,0x70,0xBE,0x7E,0xBE,0xFE,0xFC,0xFE,
0x7E,0xFE,0x7E,0x70,0x00,0xBD,0xFD,0xFD,
0xFF,0xFF,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x7F,
0xBF,0x7F,0xB4,0x75,0xB1,0x7F,0xB0,0x77,
0xB0,0x7F,0xBF,0x7F,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x7F,0xBF,0x7F,0xB0,0x7F,0xB0,0x77,
0x00,0xF7,0xF7,0xF7,0xFF,0xFF,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0x00,0xDE,0xDF,0xDF,
0xFF,0xFF,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,
0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55 
};

unsigned char code picture3[4][100]={ 	//�ѽL��
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF 
};

unsigned char code picture4[4][100]={	//�^��r��
0x00,0x00,0xC0,0x78,0x46,0x78,0xC0,0x00,
0x00,0x02,0xFE,0x12,0x12,0x12,0xEC,0x00,
0x78,0x84,0x02,0x02,0x02,0x86,0x00,0x02,
0xFE,0x02,0x02,0x02,0x84,0x78,0x00,0x02,
0xFE,0x12,0x3A,0x02,0x86,0x00,0x02,0xFE,
0x12,0x3A,0x02,0x06,0x78,0x84,0x02,0x02,
0x22,0xE6,0x20,0x02,0xFE,0x12,0x10,0x12,
0xFE,0x02,0x00,0x02,0xFE,0x02,0x00,0x00,
0x02,0xFE,0x02,0x02,0xFE,0x12,0x28,0x46,
0x82,0x02,0x00,0x02,0xFE,0x02,0x00,0x00,
0x80,0x00,0x02,0xFE,0x0E,0x70,0x80,0x70,
0x0E,0xFE,0x02,0x00,0x02,0xFE,0x08,0x30,
0x42,0xFE,0x02,0x00,0x00,0x01,0x01,0x01,
0xC0,0x21,0x11,0x11,0x10,0x21,0xC1,0x01,
0x11,0xF1,0x10,0x10,0x10,0xE0,0x01,0xC1,
0x21,0x10,0x10,0x11,0x21,0xC1,0x01,0x11,
0xF0,0x90,0x90,0x91,0x61,0x01,0x61,0x91,
0x11,0x30,0x01,0x31,0x11,0x10,0xF0,0x10,
0x10,0x30,0x01,0x11,0xF1,0x10,0x00,0x11,
0xF1,0x11,0x00,0x11,0x71,0x91,0x00,0x91,
0x71,0x11,0x10,0x71,0x91,0x00,0x10,0xF1,
0x11,0x01,0x90,0x71,0x11,0x11,0x31,0x51,
0x81,0x51,0x31,0x11,0x01,0x10,0x31,0xD1,
0x01,0xD0,0x31,0x10,0x01,0x31,0x11,0x90,
0x51,0x31,0x11,0x00,0x00,0x01,0x00,0x00,
0x00,0x00,0x00,0x00,0x83,0x04,0x08,0x08,
0x08,0x84,0x83,0x80,0x88,0x8F,0x09,0x01,
0x01,0x00,0x80,0x83,0x84,0x88,0x08,0x98,
0xA4,0xA3,0x80,0x88,0x0F,0x08,0x01,0x86,
0x88,0x88,0x8C,0x88,0x89,0x06,0x80,0x80,
0x80,0x88,0x8F,0x88,0x00,0x00,0x80,0x80,
0x87,0x88,0x08,0x88,0x87,0x80,0x00,0x80,
0x80,0x83,0x0C,0x83,0x80,0x80,0x00,0x00,
0x83,0x8C,0x83,0x80,0x83,0x8C,0x03,0x80,
0x80,0x88,0x0C,0x8A,0x81,0x8A,0x0C,0x08,
0x00,0x00,0x80,0x88,0x8F,0x08,0x00,0x00,
0x80,0x8C,0x8A,0x09,0x88,0x88,0x0C,0x00,
0x80,0x80,0x80,0x00,0x00,0x40,0x70,0x5E,
0x11,0x5E,0x70,0x40,0x00,0x40,0x7F,0x44,
0x44,0x44,0x3B,0x00,0x1E,0x21,0x40,0x40,
0x40,0x21,0x00,0x40,0x7F,0x40,0x40,0x40,
0x21,0x1E,0x00,0x40,0x7F,0x44,0x4E,0x40,
0x61,0x00,0x40,0x7F,0x44,0x0E,0x00,0x01,
0x1E,0x21,0x40,0x40,0x48,0x39,0x08,0x40,
0x7F,0x44,0x04,0x44,0x7F,0x40,0x00,0x40,
0x7F,0x40,0x00,0x40,0x40,0x3F,0x00,0x40,
0x7F,0x44,0x0A,0x51,0x60,0x40,0x40,0x40,
0x7F,0x40,0x40,0x40,0x60,0x00,0x40,0x7F,
0x43,0x1C,0x60,0x1C,0x43,0x7F,0x40,0x00,
0x40,0x7F,0x42,0x0C,0x10,0x7F,0x00,0x00 
};

void WriteIns(unsigned char inst)
{
	 RS = 0;	       
	 RW = 0;
	 Data_BUS = inst;
	 Enable = 1;            //1us
	 _nop_();		//1us
	 Enable = 0;		//1us
}

void CheckBusy(void)
{
	Data_BUS = 0xff; //�T����high�ܬ�low����e��,�ҥH�����]��high.
	RS = 0;
	RW = 1;  
	do
	{
		  Enable = 1;
		  busy_f = busy;
		  Enable = 0;
	 }while(busy_f);
}
//=================================
void WriteCmd(unsigned char cmd)
{
	 RS = 0;	       
	 RW = 0;
	 Data_BUS = cmd;
	 Enable = 1;            //1us
	 _nop_();		//1us
	 Enable = 0;		//1us
	
	CheckBusy();
}
//=================================
//=================================
void WriteData(unsigned char dat)
{
	 RS = 1;	       
	 RW = 0;
	 Data_BUS = dat;
	 Enable = 1;
	 _nop_();
	 Enable = 0;

	CheckBusy(); 
}
//=================================
//=================================
void Show_Pic(unsigned char pic[][100],unsigned char size)
{
	unsigned char i;
	
	CS1=0; //enable chip1
	CS2=1;//disable chip2

	//first line
	WriteCmd(one);//X
	WriteCmd(0x40);//Y
	for(i = 0; i<size;i++)
		WriteData(pic[0][i]);

	//second line
	WriteCmd(one);//X
	WriteCmd(0x41);//Y
	for(i = 0; i<size;i++)
		WriteData(pic[1][i]);
 
	//delay(5);
	
	CS1=1; //disable chip1
	CS2=0;//enable chip2

	//first line
	WriteCmd(one);//X
	WriteCmd(0x40);//Y
	for(i = 0; i<size;i++)
		WriteData(pic[2][i]);

	//second line
	WriteCmd(one);//X
	WriteCmd(0x41);//Y
	for(i = 0; i<size;i++)
		WriteData(pic[3][i]); 
}



//=================================
void Initial_OLED(void)
{
	CS1=0; //enable chip1
	CS2=0;//enable chip2	
	WriteIns(0x38);//function set
	WriteIns(0x38);//function set
	WriteIns(0x38);//function set
	WriteIns(0x38);//function set
	WriteCmd(0x08);//display off
	WriteCmd(0x06);//entry mode set
	WriteCmd(0x1f);//Graphic mode //80x16(seg=5x16=80,com=8x2=16)
	WriteCmd(0x01);//clear display
	WriteCmd(0x02);
	WriteCmd(0x0c);//display on
	
	
	delay(20);
}
//============================================
//==================================
void delay(unsigned char m)
{
	unsigned char i,j,k;
	 for(j = 0;j<m;j++)
 	{
	 	for(k = 0; k<200;k++)
	 	{
			for(i = 0; i<100;i++)
			{
			}
		}
 	}	
}

void main(void)
{
	Initial_OLED();

	while(1)
	{
		Show_Pic(picture,100);
		delay(15);
		Show_Pic(picture2,100);
		delay(15);
		Show_Pic(picture3,100);
		delay(15);
		Show_Pic(picture4,100);
		delay(15);
	}
}


